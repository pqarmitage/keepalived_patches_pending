diff --git a/lib/utils.c b/lib/utils.c
index b9de9f00..db76e544 100644
--- a/lib/utils.c
+++ b/lib/utils.c
@@ -534,7 +534,7 @@ string_equal(const char *str1, const char *str2)
 }
 
 void
-set_std_fd(int force)
+set_std_fd(bool force)
 {
 	int fd;
 
@@ -552,6 +552,14 @@ set_std_fd(int force)
 	signal_pipe_close(STDERR_FILENO+1);
 }
 
+void
+close_std_fd(void)
+{
+	close(STDIN_FILENO);
+	close(STDOUT_FILENO);
+	close(STDERR_FILENO);
+}
+
 #if !defined _HAVE_LIBIPTC_ || defined _LIBIPTC_DYNAMIC_
 int
 fork_exec(char **argv)
diff --git a/lib/utils.h b/lib/utils.h
index 5d0ae001..9850f2d9 100644
--- a/lib/utils.h
+++ b/lib/utils.h
@@ -71,7 +71,8 @@ extern int inet_inaddrcmp(int, void *, void *);
 extern int inet_sockaddrcmp(struct sockaddr_storage *, struct sockaddr_storage *);
 extern char *get_local_name(void);
 extern int string_equal(const char *, const char *);
-extern void set_std_fd(int);
+extern void set_std_fd(bool);
+extern void close_std_fd(void);
 #if !defined _HAVE_LIBIPTC_ || defined _LIBIPTC_DYNAMIC_
 extern int fork_exec(char **argv);
 #endif
